# Default region (UK)
REGION_PBF_URL=https://download.geofabrik.de/europe/united-kingdom-latest.osm.pbf


# Strict runtime defaults (live-first)
LIVE_RUNTIME_DATA_ENABLED=true
STRICT_LIVE_DATA_REQUIRED=true
LIVE_DATA_CACHE_TTL_S=1
# Bounded retry for transient live feed failures; strict mode still fails closed after retries.
LIVE_HTTP_MAX_ATTEMPTS=6
LIVE_HTTP_RETRY_DEADLINE_MS=30000
LIVE_HTTP_RETRY_BACKOFF_BASE_MS=200
LIVE_HTTP_RETRY_BACKOFF_MAX_MS=2500
LIVE_HTTP_RETRY_JITTER_MS=150
LIVE_HTTP_RETRY_RESPECT_RETRY_AFTER=true
LIVE_HTTP_RETRYABLE_STATUS_CODES=429,500,502,503,504
LIVE_SCENARIO_CACHE_TTL_SECONDS=1
ROUTE_CACHE_TTL_S=1

# Strict test bypass (keep disabled by default)
STRICT_RUNTIME_TEST_BYPASS=0

# Terrain live DEM (request-time)
LIVE_TERRAIN_DEM_URL_TEMPLATE=https://s3.amazonaws.com/elevation-tiles-prod/geotiff/{z}/{x}/{y}.tif
LIVE_TERRAIN_REQUIRE_URL_IN_STRICT=true
LIVE_TERRAIN_ALLOW_SIGNED_FALLBACK=false
LIVE_TERRAIN_ALLOWED_HOSTS=s3.amazonaws.com
LIVE_TERRAIN_TILE_ZOOM=8
LIVE_TERRAIN_TILE_MAX_AGE_DAYS=7
LIVE_TERRAIN_CACHE_DIR=
LIVE_TERRAIN_CACHE_MAX_TILES=1024
LIVE_TERRAIN_CACHE_MAX_MB=2048
LIVE_TERRAIN_FETCH_RETRIES=2
LIVE_TERRAIN_MAX_REMOTE_TILES_PER_ROUTE=96
LIVE_TERRAIN_CIRCUIT_BREAKER_FAILURES=8
LIVE_TERRAIN_CIRCUIT_BREAKER_COOLDOWN_S=30
LIVE_TERRAIN_ENABLE_IN_TESTS=false

# Scenario live coefficients/context
# Contract endpoint required: must return scenario coefficient JSON in this repo's strict schema.
# There is no public drop-in UK API for this payload shape.
LIVE_SCENARIO_COEFFICIENT_URL=https://raw.githubusercontent.com/snaker938/whatif-freight-router/main/backend/assets/uk/scenario_profiles_uk.json
LIVE_SCENARIO_REQUIRE_URL_IN_STRICT=true
LIVE_SCENARIO_ALLOW_SIGNED_FALLBACK=false
LIVE_SCENARIO_ALLOWED_HOSTS=webtris.nationalhighways.co.uk,www.trafficengland.com,roadtraffic.dft.gov.uk,api.open-meteo.com,archive-api.open-meteo.com,raw.githubusercontent.com
LIVE_SCENARIO_DFT_MAX_PAGES=20
SCENARIO_MIN_OBSERVED_MODE_ROW_SHARE=0.20
SCENARIO_MAX_PROJECTION_DOMINANT_CONTEXT_SHARE=0.80

# Fuel live pricing
LIVE_FUEL_PRICE_URL=https://raw.githubusercontent.com/snaker938/whatif-freight-router/main/backend/assets/uk/fuel_prices_uk.json
LIVE_FUEL_AUTH_TOKEN=
LIVE_FUEL_API_KEY=
LIVE_FUEL_API_KEY_HEADER=X-API-Key
LIVE_FUEL_REQUIRE_URL_IN_STRICT=true
LIVE_FUEL_ALLOW_SIGNED_FALLBACK=false
LIVE_FUEL_REQUIRE_SIGNATURE=true
LIVE_FUEL_ALLOWED_HOSTS=raw.githubusercontent.com

# Carbon live policy/intensity
LIVE_CARBON_SCHEDULE_URL=https://raw.githubusercontent.com/snaker938/whatif-freight-router/main/backend/assets/uk/carbon_price_schedule_uk.json
LIVE_CARBON_REQUIRE_URL_IN_STRICT=true
LIVE_CARBON_ALLOW_SIGNED_FALLBACK=false
LIVE_CARBON_ALLOWED_HOSTS=raw.githubusercontent.com
LIVE_BANK_HOLIDAYS_URL=https://www.gov.uk/bank-holidays.json
LIVE_BANK_HOLIDAYS_ALLOWED_HOSTS=www.gov.uk,gov.uk

# Departure, stochastic, toll live artifacts
LIVE_DEPARTURE_PROFILE_URL=https://raw.githubusercontent.com/snaker938/whatif-freight-router/main/backend/assets/uk/departure_profiles_uk.json
LIVE_DEPARTURE_REQUIRE_URL_IN_STRICT=true
LIVE_DEPARTURE_ALLOW_SIGNED_FALLBACK=false
LIVE_DEPARTURE_ALLOWED_HOSTS=raw.githubusercontent.com

LIVE_STOCHASTIC_REGIMES_URL=https://raw.githubusercontent.com/snaker938/whatif-freight-router/main/backend/assets/uk/stochastic_regimes_uk.json
LIVE_STOCHASTIC_REQUIRE_URL_IN_STRICT=true
LIVE_STOCHASTIC_ALLOW_SIGNED_FALLBACK=false
LIVE_STOCHASTIC_ALLOWED_HOSTS=raw.githubusercontent.com

LIVE_TOLL_TOPOLOGY_URL=https://raw.githubusercontent.com/snaker938/whatif-freight-router/main/backend/assets/uk/toll_topology_uk.json
LIVE_TOLL_TOPOLOGY_REQUIRE_URL_IN_STRICT=true
LIVE_TOLL_TOPOLOGY_ALLOW_SIGNED_FALLBACK=false

LIVE_TOLL_TARIFFS_URL=https://raw.githubusercontent.com/snaker938/whatif-freight-router/main/backend/assets/uk/toll_tariffs_uk.json
LIVE_TOLL_TARIFFS_REQUIRE_URL_IN_STRICT=true
LIVE_TOLL_TARIFFS_ALLOW_SIGNED_FALLBACK=false
LIVE_TOLL_ALLOWED_HOSTS=raw.githubusercontent.com
SCENARIO_REQUIRE_SIGNATURE=true
